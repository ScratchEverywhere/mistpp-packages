# Maintainer: Grady Link <homebrew@grady.link>

pkgname=3ds-libmistpp
pkgver=0.1.1
pkgrel=1
pkgdesc="A port of TurboWarp/mist to C++ using libcurl ."
arch=(any)
url="https://github.grady.link/mistpp"
license=("GPL3")
makedepends=('3ds-cmake' 'dkp-toolchain-vars')
depends=('3ds-curl')
source=("libmistpp-${pkgver}.tar.gz::https://github.com/gradylink/mistpp/archive/refs/tags/v${pkgver}.tar.gz")
groups=('3ds-portlibs')

build() {
  cd "$srcdir/mistpp-${pkgver}"

  mkdir build
  cd build

  source /opt/devkitpro/3dsvars.sh

  arm-none-eabi-cmake .. \
    -DCMAKE_BUILD_TYPE="Release" \
    -DCMAKE_INSTALL_PREFIX=$PORTLIBS_PREFIX \
    -DCMAKE_C_COMPILER_WORKS=true \
    -DCMAKE_CXX_COMPILER_WORKS=true \
    -DBUILD_TEST=OFF

  make
}

package() {
  cd "$srcdir/mistpp-${pkgver}/build"
  make install DESTDIR=$pkgdir
}

sha256sums=('6901e040d7ff972b209bcc4a7f145b9899d4311ff42a260fbbdd1dc81835267c')
